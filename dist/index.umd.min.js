!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("react")):"function"==typeof define&&define.amd?define(["exports","react"],e):e((t=t||self).ReactIoC={},t.React)}(this,function(t,e){"use strict";var s="default"in e?e.default:e,r={data:{},get(t){return this.data[t]},register(t,e){this.data[t]=e}};const n={data:{},get(t){return this.data[t]},set(t,e){if(void 0!==this.data[t])throw new Error(`${t} is already exists.`);this.data[t]=e}};class i{constructor(t){this.isStopped=!1,this.destination=this.safeObserver(t)}safeObserver(t){return{next:t}}next(t){if(!this.isStopped&&this.next)try{this.destination.next(t)}catch(t){throw this.unsubscribe(),t}}error(t){if(!this.isStopped&&this.error){try{this.destination.error(t)}catch(t){throw this.unsubscribe(),t}this.unsubscribe()}}complete(){if(!this.isStopped&&this.complete){try{this.destination.complete()}catch(t){throw this.unsubscribe(),t}this.unsubscribe()}}unsubscribe(){this.isStopped=!0}}class o{constructor(){this.closed=!1,this.observers=[]}next(t){this.closed||this.observers.forEach(e=>e.next(t))}subscribe(t){const e=new i(t);return this.observers.push(e),e}unsubscribe(){this.closed=!0}}class c extends o{constructor(t){super(),this.store=t}get value(){return this.getValue()}getValue(){if(this.closed)throw new Error("subject has been closed.");return this.store}next(t){this.store=t,super.next(t)}subscribe(t){const e=super.subscribe(t);return e.next(this.store),e}}t.Provider=(t=>{if(void 0!==r.get(t))throw new Error(`${t} is already regist.`);const i=e.createContext({});return r.register(t,i),t=>(class extends e.Component{constructor(){super(...arguments),this.state={context:{}}}componentDidMount(){n.get(t.name).subscribe(t=>{this.setState({context:t})})}render(){return s.createElement(i.Provider,{value:this.state.context},s.createElement(t,Object.assign({},this.props)))}})}),t.Context=((t,e,s)=>{const r=t.constructor.name;let i=s.initializer();n.get(r)||n.set(r,new c({}));const o=n.get(r);function h(t){o.subscribe(s=>{s[e]!==t&&o.next(Object.assign({},s,{[e]:t}))}).unsubscribe()}h(i);return{configurable:!0,enumerable:!1,get:()=>i,set:t=>{h(t),i=t}}}),t.Listener=((t,e)=>{const s=t.constructor.name;n.get(s)||n.set(s,new c({}));const r=n.get(s),i=new o;r.subscribe(t=>{void 0===t[e]&&r.next(Object.assign({},t,{[e]:function(t){i.next(t)}}))}).unsubscribe();return{configurable:!0,enumerable:!1,get:()=>i,set:()=>{console.log(`can note set listen: ${e}, it's readonly.`)}}}),t.Consumer=((t,n)=>i=>(class extends e.Component{constructor(){super(...arguments),this.renderContext=(t=>{let e={};return n?n.forEach(s=>{e[s]=t[s]}):e=t,s.createElement(i,Object.assign({},e))})}render(){const e=r.get(t);return e?s.createElement(e.Consumer,null,this.renderContext):null}})),Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=index.umd.min.js.map
